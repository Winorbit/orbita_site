version: '3'
services:
    web-api:
        container_name: web-api
        build: ./web_api
        restart: always
        expose:
            - ${PORT_API}
        command: gunicorn --reload -w 4  -b :${PORT_API} --env DJANGO_SETTINGS_MODULE=content.settings content.wsgi
        volumes:
            - ./web_api/:/home/orbita_site/web_api

    web-ui:
        container_name: web-ui
        build: ./web_ui
        restart: always
        expose:
            - ${PORT_UI}
        command: gunicorn --reload -w 4  -b :${PORT_UI} --env DJANGO_SETTINGS_MODULE=Orbit.settings Orbit.wsgi
        volumes:
            - ./web_ui/:/home/orbita_site/web_ui
        depends_on:
            - web-api

    nginx:
        container_name: nginx
        image: nginx:alpine
        restart: always
        volumes:
            - ./nginx/:/etc/nginx/conf.d/
        ports:
            - ${PORT_NGINX}:80
        depends_on:
            - web-ui